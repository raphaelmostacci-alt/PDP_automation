üìã Contexte du Projet PDP_automation (Version C + IA uniquement)

Objectif Principal :
Cr√©er un syst√®me automatis√© en langage C pour v√©rifier la conformit√© des documents obligatoires 
des entreprises ext√©rieures intervenant dans un laboratoire, en utilisant uniquement une IA (ChatGPT) 
pour l'analyse des documents (pas d'OCR traditionnel).

================================================================================
Documents √† Analyser :
================================================================================
1. CNI (Carte Nationale d'Identit√©) - validit√© 10-15 ans
2. Habilitations √âlectriques - validit√© 3 ans
3. FDS (Fiches de Donn√©es de S√©curit√©) - doivent √™tre >= 2021
4. Aptitudes Frigorifiques - valides √† vie

================================================================================
Workflow Technique Demand√© :
================================================================================

ENTR√âE :
- Dossier contenant tous les documents (PDF, JPG, PNG, TIF)
- Tous les documents seront analys√©s par l'IA

PROCESSUS :

1. Scanner le dossier d'entr√©e (fonctions C)
   - Utiliser opendir(), readdir() pour lister les fichiers
   - Compter le nombre total de fichiers √† analyser
   - Filtrer par extension (.pdf, .jpg, .png, .tif)

2. Boucle d'analyse (while jusqu'√† traiter tous les fichiers)
   
   while (nb_fichiers_traites < nb_fichiers_total) {
       // Ouvrir le fichier courant
       
       // Envoyer le fichier √† l'IA via API HTTP
       // Utiliser libcurl pour faire des requ√™tes HTTP √† l'API ChatGPT
       
       // Demander √† l'IA d'extraire:
       //   - Type de document (CNI/Habilitation/FDS/Aptitude)
       //   - Nom, Pr√©nom de la personne
       //   - Entreprise
       //   - Date de validit√© ou d'√©mission
       
       // Parser la r√©ponse JSON de l'IA (avec cJSON ou similaire)
       
       // Valider selon les r√®gles m√©tier (fonctions de validation)
       //   - CNI: calculer si date < 10 ou 15 ans
       //   - Habilitation: date < 3 ans
       //   - FDS: ann√©e >= 2021
       //   - Aptitude Frigo: toujours valide
       
       // √âcrire dans fichier CSV (fopen, fprintf)
       //   Format: Entreprise,Nom,Prenom,Type,Fichier,DateValidite,Statut,Commentaire
       
       // Fermer le fichier proprement
       // Incr√©menter compteur
   }

3. Apr√®s la boucle
   - Fermer le fichier CSV
   - Afficher statistiques √† l'√©cran (printf)
   - Sauvegarder dans dossier output/

SORTIE :
- Fichier CSV : rapport_pdp_YYYYMMDD.csv
- Log en console

================================================================================
Architecture Modulaire (fichiers .c et .h) :
================================================================================

Fichiers requis :
- main.c : fonction main(), orchestration g√©n√©rale
- file_scanner.c / .h : scanner de dossier, comptage fichiers
- ai_client.c / .h : communication avec l'API ChatGPT (libcurl)
- json_parser.c / .h : parser les r√©ponses JSON de l'IA
- validator.c / .h : r√®gles de validation m√©tier
- csv_writer.c / .h : √©criture du rapport CSV
- config.h : constantes (chemins, r√®gles de validit√©)
- makefile : compilation avec gcc

Structures de donn√©es sugg√©r√©es :

typedef struct {
    char entreprise[100];
    char nom[50];
    char prenom[50];
    char type_document[30];
    char chemin_fichier[256];
    char date_validite[20];
    char statut[20];  // "CONFORME" ou "NON_CONFORME"
    char commentaire[200];
} Document;

================================================================================
Contraintes Techniques :
================================================================================

Langage : C ANSI (gcc)
Pas d'OCR local : Tout passe par l'IA

Biblioth√®ques externes autoris√©es :
  - libcurl : pour requ√™tes HTTP vers API ChatGPT
  - cJSON : pour parser les r√©ponses JSON
  - Biblioth√®ques standard C : stdio.h, stdlib.h, string.h, dirent.h, time.h

Modularit√© : 
  - Prototypes dans fichiers .h
  - Impl√©mentations dans fichiers .c
  - Compilation via makefile

Gestion m√©moire :
  - Allocation dynamique avec malloc() pour liste de fichiers
  - Lib√©ration avec free()
  - Pas de fuites m√©moire

Gestion d'erreurs :
  - V√©rifier tous les fopen(), malloc(), appels API
  - Continuer le traitement m√™me si un fichier √©choue
  - Logger les erreurs dans le CSV avec statut "ERREUR"

API ChatGPT :
  - URL : https://api.openai.com/v1/chat/completions (ou chat.st.com)
  - Authentification : Bearer token dans headers
  - Envoyer le chemin du fichier + prompt demandant extraction d'infos
  - Recevoir r√©ponse JSON structur√©e

Makefile cible :

CC = gcc
CFLAGS = -Wall -Wextra -std=c99
LIBS = -lcurl -lcjson

pdp_automation: main.o file_scanner.o ai_client.o validator.o csv_writer.o
    $(CC) -o $@ $^ $(LIBS)

================================================================================
R√©sum√© :
================================================================================
Un programme C modulaire qui scanne un dossier, envoie chaque document √† une IA 
via API, parse les r√©sultats JSON, valide selon des r√®gles m√©tier, et g√©n√®re un 
rapport CSV de conformit√©.
